// Copyright Jiangsu Rongzer Information Technology Co., Ltd. 2020 All Rights Reserved.
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//                 http://www.apache.org/licenses/LICENSE-2.0
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
package sm3

import (
	"math/bits"
)

//func blockGeneric(digest *digest, p []byte) {
//	var w [68]uint32
//	a, b, c, d, e, f, g, h := digest.h[0], digest.h[1], digest.h[2], digest.h[3], digest.h[4], digest.h[5], digest.h[6], digest.h[7]
//
//	n := len(p) / 64
//	for v := 0; v < n; v++ {
//		A, B, C, D, E, F, G, H := a, b, c, d, e, f, g, h
//
//		for i := 0; i < 16; i++ {
//			j := i * 4
//			w[i] = uint32(p[j])<<24 | uint32(p[j+1])<<16 | uint32(p[j+2])<<8 | uint32(p[j+3])
//		}
//		for i := 16; i < 68; i++ {
//			v1 := w[i-16] ^ w[i-9] ^ bits.RotateLeft32(w[i-3], 15)
//			t1 := v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)
//			w[i] = t1 ^ bits.RotateLeft32(w[i-13], 7) ^ w[i-6]
//		}
//
//		var t1, t2 uint32
//		for i := 0; i < 64; i++ {
//			v1 := bits.RotateLeft32(A, 12)
//			s1 := bits.RotateLeft32(v1+E+_K[i], 7)
//			s2 := s1 ^ v1
//			if i < 16 {
//				t1 = (A ^ B ^ C) + D + s2 + (w[i] ^ w[i+4])
//				t2 = (E ^ F ^ G) + H + s1 + w[i]
//			} else {
//				t1 = ((A & B) | (A & C) | (B & C)) + D + s2 + (w[i] ^ w[i+4])
//				t2 = ((E & F) | (^E & G)) + H + s1 + w[i]
//			}
//
//			D = C
//			C = bits.RotateLeft32(B, 9)
//			B = A
//			A = t1
//			H = G
//			G = bits.RotateLeft32(F, 19)
//			F = E
//			E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
//		}
//
//		a ^= A
//		b ^= B
//		c ^= C
//		d ^= D
//		e ^= E
//		f ^= F
//		g ^= G
//		h ^= H
//		p = p[64:]
//	}
//	digest.h[0], digest.h[1], digest.h[2], digest.h[3], digest.h[4], digest.h[5], digest.h[6], digest.h[7] = a, b, c, d, e, f, g, h
//	return
//}
func blockGeneric(digest *digest, p []byte) {
	var w [68]uint32
	a, b, c, d, e, f, g, h := digest.h[0], digest.h[1], digest.h[2], digest.h[3], digest.h[4], digest.h[5], digest.h[6], digest.h[7]

	n := len(p) / 64
	for v := 0; v < n; v++ {
		A, B, C, D, E, F, G, H := a, b, c, d, e, f, g, h

		w[0] = uint32(p[0])<<24 | uint32(p[0+1])<<16 | uint32(p[0+2])<<8 | uint32(p[0+3])
		w[1] = uint32(p[4])<<24 | uint32(p[4+1])<<16 | uint32(p[4+2])<<8 | uint32(p[4+3])
		w[2] = uint32(p[8])<<24 | uint32(p[8+1])<<16 | uint32(p[8+2])<<8 | uint32(p[8+3])
		w[3] = uint32(p[12])<<24 | uint32(p[12+1])<<16 | uint32(p[12+2])<<8 | uint32(p[12+3])
		w[4] = uint32(p[16])<<24 | uint32(p[16+1])<<16 | uint32(p[16+2])<<8 | uint32(p[16+3])
		w[5] = uint32(p[20])<<24 | uint32(p[20+1])<<16 | uint32(p[20+2])<<8 | uint32(p[20+3])
		w[6] = uint32(p[24])<<24 | uint32(p[24+1])<<16 | uint32(p[24+2])<<8 | uint32(p[24+3])
		w[7] = uint32(p[28])<<24 | uint32(p[28+1])<<16 | uint32(p[28+2])<<8 | uint32(p[28+3])
		w[8] = uint32(p[32])<<24 | uint32(p[32+1])<<16 | uint32(p[32+2])<<8 | uint32(p[32+3])
		w[9] = uint32(p[36])<<24 | uint32(p[36+1])<<16 | uint32(p[36+2])<<8 | uint32(p[36+3])
		w[10] = uint32(p[40])<<24 | uint32(p[40+1])<<16 | uint32(p[40+2])<<8 | uint32(p[40+3])
		w[11] = uint32(p[44])<<24 | uint32(p[44+1])<<16 | uint32(p[44+2])<<8 | uint32(p[44+3])
		w[12] = uint32(p[48])<<24 | uint32(p[48+1])<<16 | uint32(p[48+2])<<8 | uint32(p[48+3])
		w[13] = uint32(p[52])<<24 | uint32(p[52+1])<<16 | uint32(p[52+2])<<8 | uint32(p[52+3])
		w[14] = uint32(p[56])<<24 | uint32(p[56+1])<<16 | uint32(p[56+2])<<8 | uint32(p[56+3])
		w[15] = uint32(p[60])<<24 | uint32(p[60+1])<<16 | uint32(p[60+2])<<8 | uint32(p[60+3])

		v1 := w[16-16] ^ w[16-9] ^ bits.RotateLeft32(w[16-3], 15)
		w[16] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[16-13], 7) ^ w[16-6]
		v1 = w[17-16] ^ w[17-9] ^ bits.RotateLeft32(w[17-3], 15)
		w[17] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[17-13], 7) ^ w[17-6]
		v1 = w[18-16] ^ w[18-9] ^ bits.RotateLeft32(w[18-3], 15)
		w[18] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[18-13], 7) ^ w[18-6]
		v1 = w[19-16] ^ w[19-9] ^ bits.RotateLeft32(w[19-3], 15)
		w[19] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[19-13], 7) ^ w[19-6]
		v1 = w[20-16] ^ w[20-9] ^ bits.RotateLeft32(w[20-3], 15)
		w[20] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[20-13], 7) ^ w[20-6]
		v1 = w[21-16] ^ w[21-9] ^ bits.RotateLeft32(w[21-3], 15)
		w[21] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[21-13], 7) ^ w[21-6]
		v1 = w[22-16] ^ w[22-9] ^ bits.RotateLeft32(w[22-3], 15)
		w[22] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[22-13], 7) ^ w[22-6]
		v1 = w[23-16] ^ w[23-9] ^ bits.RotateLeft32(w[23-3], 15)
		w[23] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[23-13], 7) ^ w[23-6]
		v1 = w[24-16] ^ w[24-9] ^ bits.RotateLeft32(w[24-3], 15)
		w[24] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[24-13], 7) ^ w[24-6]
		v1 = w[25-16] ^ w[25-9] ^ bits.RotateLeft32(w[25-3], 15)
		w[25] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[25-13], 7) ^ w[25-6]
		v1 = w[26-16] ^ w[26-9] ^ bits.RotateLeft32(w[26-3], 15)
		w[26] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[26-13], 7) ^ w[26-6]
		v1 = w[27-16] ^ w[27-9] ^ bits.RotateLeft32(w[27-3], 15)
		w[27] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[27-13], 7) ^ w[27-6]
		v1 = w[28-16] ^ w[28-9] ^ bits.RotateLeft32(w[28-3], 15)
		w[28] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[28-13], 7) ^ w[28-6]
		v1 = w[29-16] ^ w[29-9] ^ bits.RotateLeft32(w[29-3], 15)
		w[29] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[29-13], 7) ^ w[29-6]
		v1 = w[30-16] ^ w[30-9] ^ bits.RotateLeft32(w[30-3], 15)
		w[30] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[30-13], 7) ^ w[30-6]
		v1 = w[31-16] ^ w[31-9] ^ bits.RotateLeft32(w[31-3], 15)
		w[31] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[31-13], 7) ^ w[31-6]
		v1 = w[32-16] ^ w[32-9] ^ bits.RotateLeft32(w[32-3], 15)
		w[32] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[32-13], 7) ^ w[32-6]
		v1 = w[33-16] ^ w[33-9] ^ bits.RotateLeft32(w[33-3], 15)
		w[33] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[33-13], 7) ^ w[33-6]
		v1 = w[34-16] ^ w[34-9] ^ bits.RotateLeft32(w[34-3], 15)
		w[34] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[34-13], 7) ^ w[34-6]
		v1 = w[35-16] ^ w[35-9] ^ bits.RotateLeft32(w[35-3], 15)
		w[35] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[35-13], 7) ^ w[35-6]
		v1 = w[36-16] ^ w[36-9] ^ bits.RotateLeft32(w[36-3], 15)
		w[36] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[36-13], 7) ^ w[36-6]
		v1 = w[37-16] ^ w[37-9] ^ bits.RotateLeft32(w[37-3], 15)
		w[37] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[37-13], 7) ^ w[37-6]
		v1 = w[38-16] ^ w[38-9] ^ bits.RotateLeft32(w[38-3], 15)
		w[38] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[38-13], 7) ^ w[38-6]
		v1 = w[39-16] ^ w[39-9] ^ bits.RotateLeft32(w[39-3], 15)
		w[39] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[39-13], 7) ^ w[39-6]
		v1 = w[40-16] ^ w[40-9] ^ bits.RotateLeft32(w[40-3], 15)
		w[40] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[40-13], 7) ^ w[40-6]
		v1 = w[41-16] ^ w[41-9] ^ bits.RotateLeft32(w[41-3], 15)
		w[41] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[41-13], 7) ^ w[41-6]
		v1 = w[42-16] ^ w[42-9] ^ bits.RotateLeft32(w[42-3], 15)
		w[42] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[42-13], 7) ^ w[42-6]
		v1 = w[43-16] ^ w[43-9] ^ bits.RotateLeft32(w[43-3], 15)
		w[43] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[43-13], 7) ^ w[43-6]
		v1 = w[44-16] ^ w[44-9] ^ bits.RotateLeft32(w[44-3], 15)
		w[44] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[44-13], 7) ^ w[44-6]
		v1 = w[45-16] ^ w[45-9] ^ bits.RotateLeft32(w[45-3], 15)
		w[45] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[45-13], 7) ^ w[45-6]
		v1 = w[46-16] ^ w[46-9] ^ bits.RotateLeft32(w[46-3], 15)
		w[46] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[46-13], 7) ^ w[46-6]
		v1 = w[47-16] ^ w[47-9] ^ bits.RotateLeft32(w[47-3], 15)
		w[47] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[47-13], 7) ^ w[47-6]
		v1 = w[48-16] ^ w[48-9] ^ bits.RotateLeft32(w[48-3], 15)
		w[48] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[48-13], 7) ^ w[48-6]
		v1 = w[49-16] ^ w[49-9] ^ bits.RotateLeft32(w[49-3], 15)
		w[49] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[49-13], 7) ^ w[49-6]
		v1 = w[50-16] ^ w[50-9] ^ bits.RotateLeft32(w[50-3], 15)
		w[50] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[50-13], 7) ^ w[50-6]
		v1 = w[51-16] ^ w[51-9] ^ bits.RotateLeft32(w[51-3], 15)
		w[51] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[51-13], 7) ^ w[51-6]
		v1 = w[52-16] ^ w[52-9] ^ bits.RotateLeft32(w[52-3], 15)
		w[52] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[52-13], 7) ^ w[52-6]
		v1 = w[53-16] ^ w[53-9] ^ bits.RotateLeft32(w[53-3], 15)
		w[53] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[53-13], 7) ^ w[53-6]
		v1 = w[54-16] ^ w[54-9] ^ bits.RotateLeft32(w[54-3], 15)
		w[54] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[54-13], 7) ^ w[54-6]
		v1 = w[55-16] ^ w[55-9] ^ bits.RotateLeft32(w[55-3], 15)
		w[55] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[55-13], 7) ^ w[55-6]
		v1 = w[56-16] ^ w[56-9] ^ bits.RotateLeft32(w[56-3], 15)
		w[56] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[56-13], 7) ^ w[56-6]
		v1 = w[57-16] ^ w[57-9] ^ bits.RotateLeft32(w[57-3], 15)
		w[57] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[57-13], 7) ^ w[57-6]
		v1 = w[58-16] ^ w[58-9] ^ bits.RotateLeft32(w[58-3], 15)
		w[58] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[58-13], 7) ^ w[58-6]
		v1 = w[59-16] ^ w[59-9] ^ bits.RotateLeft32(w[59-3], 15)
		w[59] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[59-13], 7) ^ w[59-6]
		v1 = w[60-16] ^ w[60-9] ^ bits.RotateLeft32(w[60-3], 15)
		w[60] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[60-13], 7) ^ w[60-6]
		v1 = w[61-16] ^ w[61-9] ^ bits.RotateLeft32(w[61-3], 15)
		w[61] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[61-13], 7) ^ w[61-6]
		v1 = w[62-16] ^ w[62-9] ^ bits.RotateLeft32(w[62-3], 15)
		w[62] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[62-13], 7) ^ w[62-6]
		v1 = w[63-16] ^ w[63-9] ^ bits.RotateLeft32(w[63-3], 15)
		w[63] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[63-13], 7) ^ w[63-6]
		v1 = w[64-16] ^ w[64-9] ^ bits.RotateLeft32(w[64-3], 15)
		w[64] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[64-13], 7) ^ w[64-6]
		v1 = w[65-16] ^ w[65-9] ^ bits.RotateLeft32(w[65-3], 15)
		w[65] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[65-13], 7) ^ w[65-6]
		v1 = w[66-16] ^ w[66-9] ^ bits.RotateLeft32(w[66-3], 15)
		w[66] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[66-13], 7) ^ w[66-6]
		v1 = w[67-16] ^ w[67-9] ^ bits.RotateLeft32(w[67-3], 15)
		w[67] = (v1 ^ bits.RotateLeft32(v1, 15) ^ bits.RotateLeft32(v1, 23)) ^ bits.RotateLeft32(w[67-13], 7) ^ w[67-6]

		v1 = bits.RotateLeft32(A, 12)
		v2 := bits.RotateLeft32(v1+E+2043430169, 7)
		t1 := (A ^ B ^ C) + D + (v2 ^ v1) + (w[0] ^ w[0+4])
		t2 := (E ^ F ^ G) + H + v2 + w[0]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+4086860338, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[1] ^ w[1+4])
		t2 = (E ^ F ^ G) + H + v2 + w[1]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3878753381, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[2] ^ w[2+4])
		t2 = (E ^ F ^ G) + H + v2 + w[2]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3462539467, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[3] ^ w[3+4])
		t2 = (E ^ F ^ G) + H + v2 + w[3]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2630111639, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[4] ^ w[4+4])
		t2 = (E ^ F ^ G) + H + v2 + w[4]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+965255983, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[5] ^ w[5+4])
		t2 = (E ^ F ^ G) + H + v2 + w[5]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1930511966, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[6] ^ w[6+4])
		t2 = (E ^ F ^ G) + H + v2 + w[6]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3861023932, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[7] ^ w[7+4])
		t2 = (E ^ F ^ G) + H + v2 + w[7]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3427080569, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[8] ^ w[8+4])
		t2 = (E ^ F ^ G) + H + v2 + w[8]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2559193843, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[9] ^ w[9+4])
		t2 = (E ^ F ^ G) + H + v2 + w[9]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+823420391, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[10] ^ w[10+4])
		t2 = (E ^ F ^ G) + H + v2 + w[10]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1646840782, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[11] ^ w[11+4])
		t2 = (E ^ F ^ G) + H + v2 + w[11]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3293681564, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[12] ^ w[12+4])
		t2 = (E ^ F ^ G) + H + v2 + w[12]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2292395833, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[13] ^ w[13+4])
		t2 = (E ^ F ^ G) + H + v2 + w[13]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+289824371, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[14] ^ w[14+4])
		t2 = (E ^ F ^ G) + H + v2 + w[14]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+579648742, 7)
		t1 = (A ^ B ^ C) + D + (v2 ^ v1) + (w[15] ^ w[15+4])
		t2 = (E ^ F ^ G) + H + v2 + w[15]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)

		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2643098247, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[16] ^ w[16+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[16]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+991229199, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[17] ^ w[17+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[17]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1982458398, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[18] ^ w[18+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[18]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3964916796, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[19] ^ w[19+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[19]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3634866297, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[20] ^ w[20+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[20]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2974765299, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[21] ^ w[21+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[21]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1654563303, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[22] ^ w[22+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[22]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3309126606, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[23] ^ w[23+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[23]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2323285917, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[24] ^ w[24+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[24]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+351604539, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[25] ^ w[25+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[25]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+703209078, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[26] ^ w[26+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[26]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1406418156, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[27] ^ w[27+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[27]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2812836312, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[28] ^ w[28+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[28]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1330705329, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[29] ^ w[29+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[29]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2661410658, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[30] ^ w[30+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[30]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1027854021, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[31] ^ w[31+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[31]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2055708042, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[32] ^ w[32+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[32]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+4111416084, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[33] ^ w[33+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[33]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3927864873, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[34] ^ w[34+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[34]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3560762451, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[35] ^ w[35+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[35]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2826557607, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[36] ^ w[36+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[36]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1358147919, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[37] ^ w[37+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[37]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2716295838, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[38] ^ w[38+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[38]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1137624381, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[39] ^ w[39+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[39]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2275248762, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[40] ^ w[40+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[40]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+255530229, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[41] ^ w[41+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[41]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+511060458, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[42] ^ w[42+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[42]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1022120916, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[43] ^ w[43+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[43]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2044241832, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[44] ^ w[44+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[44]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+4088483664, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[45] ^ w[45+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[45]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3882000033, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[46] ^ w[46+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[46]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3469032771, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[47] ^ w[47+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[47]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2643098247, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[48] ^ w[48+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[48]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+991229199, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[49] ^ w[49+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[49]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1982458398, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[50] ^ w[50+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[50]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3964916796, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[51] ^ w[51+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[51]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3634866297, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[52] ^ w[52+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[52]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2974765299, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[53] ^ w[53+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[53]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1654563303, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[54] ^ w[54+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[54]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+3309126606, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[55] ^ w[55+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[55]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2323285917, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[56] ^ w[56+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[56]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+351604539, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[57] ^ w[57+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[57]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+703209078, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[58] ^ w[58+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[58]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1406418156, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[59] ^ w[59+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[59]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2812836312, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[60] ^ w[60+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[60]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1330705329, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[61] ^ w[61+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[61]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+2661410658, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[62] ^ w[62+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[62]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)
		v1 = bits.RotateLeft32(A, 12)
		v2 = bits.RotateLeft32(v1+E+1027854021, 7)
		t1 = ((A & B) | (A & C) | (B & C)) + D + (v2 ^ v1) + (w[63] ^ w[63+4])
		t2 = ((E & F) | (^E & G)) + H + v2 + w[63]
		D = C
		C = bits.RotateLeft32(B, 9)
		B = A
		A = t1
		H = G
		G = bits.RotateLeft32(F, 19)
		F = E
		E = t2 ^ bits.RotateLeft32(t2, 9) ^ bits.RotateLeft32(t2, 17)

		a ^= A
		b ^= B
		c ^= C
		d ^= D
		e ^= E
		f ^= F
		g ^= G
		h ^= H
		p = p[64:]
	}
	digest.h[0], digest.h[1], digest.h[2], digest.h[3], digest.h[4], digest.h[5], digest.h[6], digest.h[7] = a, b, c, d, e, f, g, h
	return
}
